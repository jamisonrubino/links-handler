{"changed":true,"filter":false,"title":"edit_links.html.erb","tooltip":"/app/views/welcome/edit_links.html.erb","value":"<%= form_tag(\"/all_links\", id: \"edit-links\", method: \"post\") do %>\n  <div id=\"ready\">\n    <span>Ready to submit</span>\n  </div>\n  <% puts @converted_links %>\n  <% @converted_links.each_with_index do |section, i| %>\n    <div class=\"section\">\n      <%= \"<h2>#{section['section']}</h2>\".html_safe %>\n      <% section['links'].each_with_index do |link, j| %>\n      \n        <span class=\"link\">\n          <% unless link['title'].nil? %>\n            <span class=\"edit-link\" onClick=\"toggleInput(<%= \"#{i}, #{j}\"  %>);\">[Edit]</span>\n            <span class=\"author\"><%= \"<b>#{link['author']} - </b>\".html_safe %></span>\n            <%= text_field_tag \"author#{i}[#{j}]\", \"\", class: \"author-input hide\" %>\n              <% @temp_title = (link['title'] == \"manual\" ? link['placeholder'] : link['title']) %>\n            <%= text_field_tag \"title#{i}[#{j}]\", \"\", class: \"title-input hide\" %>\n            <% @temp_title.split(\" \").each_with_index do |title_word, x| %>\n              <span>\n                <a onClick=\"caseChange(this, <%= \"#{i}, #{j}, #{x}\" %>);\" class=\"title-word\"><%= title_word %></a>\n                <%= check_box_tag \"#{i}[#{j}[#{x}]][]\", \"dc\", false, class: \"hidden\" %>\n                <%= check_box_tag \"#{i}[#{j}[#{x}]][]\", \"uc\", false, class: \"hidden\" %>\n                <%= check_box_tag \"#{i}[#{j}[#{x}]][]\", \"tc\", false, class: \"hidden\" %>\n                <%= check_box_tag \"#{i}[#{j}[#{x}]][]\", \"del\", false, class: \"hidden\" %>\n              </span>\n            <% end %>\n            \n            <%= link_to \"#{link['url'].slice(0, 30)}...\", link['url'], class: \"url\", target: \"_blank\" %>\n            <span class=\"flaggedspan\">\n              <% if (@temp_title.size+link['author'].size+3 > 77 || link['title'] == \"manual\") %>\n                <%= check_box_tag \"f#{i}[#{j}]\", \"flagged\", true %>\n              <% else %>\n                <%= check_box_tag \"f#{i}[#{j}]\", \"flagged\", false %>\n              <% end %>\n  \n              <%= label_tag \"f#{i}[#{j}]\", \"Flag\" %>\n            </span>\n            <br>\n          <% end %>\n        </span>\n      <% end %>\n    </div>\n  <% end %>\n  <br><br>\n  <%= submit_tag \"To HTML\" %>\n<% end %>\n\n<%= form_tag(\"/all_links\", id: \"add-new-site\", method: \"post\") do %>\n  <%= text_area_tag(:sites, @new_sites_html, size: \"50x8\") %> \n  <%= submit_tag \"Update site info\" %>\n<% end %>\n\n\n<script>\n  (function(){\n    $(\"#edit-links input[type=submit]\").prop(\"disabled\", true);\n      var disabled = true;\n      $(\"#ready\").click(function(){\n        if (disabled===true) {\n          disabled = false;\n          $(\"#edit-links input[type=submit]\").removeAttr(\"disabled\");\n          $(\"#ready span\").addClass(\"ready\");\n        } else {\n          disabled = true;\n          $(\"#edit-links input[type=submit]\").prop(\"disabled\", true);\n          $(\"#ready span\").removeClass();\n        }\n      });\n    \n    $(\"span.flaggedspan\").each(function(i) {\n    \t$(this).change(function() {\n        \tflag(i);\n    \t});\n    \tif ($(this).find(\"input\").is(\":checked\")) $(\"span.link\").eq(i).addClass(\"flagged\");\n    });\n  }());\n  \n  \n  \n  function flag(index) {\n    $(\"span.flaggedspan\").eq(index).find(\"input\").is(\":checked\") ? $(\"span.link\").eq(index).addClass(\"flagged\") : $(\"span.link\").eq(index).removeClass(\"flagged\");\n  }\n  \n  function caseChange(link, i, j, x) {\n    var newLink = link.innerHTML;\n    var reg = /^[a-zA-Z]$/;\n    var cap; \n    var sliced = false;\n    var beg = false;\n\n    \n    var tcBox = $(\"input:checkbox[name='\"+i+\"[\"+j+\"[\"+x+\"]][]']\").filter(\"[value='tc']\");\n    var ucBox = $(\"input:checkbox[name='\"+i+\"[\"+j+\"[\"+x+\"]][]']\").filter(\"[value='uc']\");\n    var dcBox = $(\"input:checkbox[name='\"+i+\"[\"+j+\"[\"+x+\"]][]']\").filter(\"[value='dc']\");\n    var delBox = $(\"input:checkbox[name='\"+i+\"[\"+j+\"[\"+x+\"]][]']\").filter(\"[value='del']\");\n    \n    // FIND THE FIRST A-Za-z CHAR, SEPARATE BEGINNING CHARS FROM LETTERS, MANIPULATE LETTERS, REJOIN LATER\n    if (reg.test(newLink[0]) === false) {  \n      for (var i=0; i<newLink.length; i++) {\n        if (reg.test(newLink[i]) === true) {\n          sliced = true;\n          beg = newLink.slice(0,i);\n          newLink = newLink.slice(i);\n          break;\n        }\n      }\n    }\n      \n      \n    if (newLink === newLink.toUpperCase() && delBox.is(\":checked\") == false) {\n      console.log(link);\n      link.classList.add(\"del\");\n    \n      tcBox.prop(\"checked\", false);\n      ucBox.prop(\"checked\", false);\n      dcBox.prop(\"checked\", false);  \n      delBox.prop(\"checked\", true);\n      \n    } else if (delBox.is(\":checked\")) {\n      if (sliced) {\n        link.innerHTML = beg + newLink.toLowerCase();\n      } else {\n        link.innerHTML = newLink.toLowerCase();\n      }\n      \n      link.classList.remove(\"del\");\n      \n      delBox.prop(\"checked\", false);\n      tcBox.prop(\"checked\", false);\n      ucBox.prop(\"checked\", false);\n      dcBox.prop(\"checked\", true);\n\n    } else if (newLink[0] === newLink[0].toUpperCase() && newLink !== newLink.toUpperCase()) {\n      if (sliced) {\n        link.innerHTML = beg + newLink.toUpperCase();\n      } else {\n        link.innerHTML = newLink.toUpperCase();\n      }\n      \n      tcBox.prop(\"checked\", false);\n      dcBox.prop(\"checked\", false);\n      ucBox.prop(\"checked\", true);\n      \n    } else if (newLink === newLink.toLowerCase()) {\n      if (sliced) {\n        link.innerHTML = beg + newLink[0].toUpperCase() + newLink.slice(1);\n      } else {\n        link.innerHTML = newLink[0].toUpperCase() + newLink.slice(1);\n      }\n      dcBox.prop(\"checked\", false);\n      ucBox.prop(\"checked\", false);\n      tcBox.prop(\"checked\", true);\n    }\n  }\n  \n  function toggleInput(i, j) {\n    var link = $(\".section\").eq(i).find($(\"span.link\")).eq(j);\n    if (link.find(\"span.author\").text().length > 0) var author = link.find(\"span.author\").text();\n    var title = [];\n    link.children().each((index) => {\n      let word = link.find(\"span\").eq(index);\n      if (word.hasClass(\"\")) {\n        title.push(word.find(\"a\").eq(0).text()); \n        if (!word.hasClass(\"flaggedspan\")) {\n          word.addClass(\"hide\");\n        }\n      } else if (word.hasClass(\"author\") || word.hasClass(\"edit-link\")) {\n        word.addClass(\"hide\");\n      }\n    });\n\n    $(\".section\").eq(i).find($(\"input.title-input\")).eq(j).val(title.join(\" \"));\n    $(\".section\").eq(i).find($(\"input.author-input\")).eq(j).val(author.slice(0,-3));\n    $(\".section\").eq(i).find($(\"input.title-input\")).eq(j).removeClass(\"hide\");\n    $(\".section\").eq(i).find($(\"input.author-input\")).eq(j).removeClass(\"hide\");\n  }\n  \n  $(window).on(\"beforeunload\", e=>confirm(\"Are you sure you want to leave?\"))\n\n\n</script>","undoManager":{"mark":98,"position":100,"stack":[[{"start":{"row":47,"column":63},"end":{"row":48,"column":0},"action":"remove","lines":["",""],"id":1275}],[{"start":{"row":47,"column":32},"end":{"row":47,"column":36},"action":"remove","lines":["edit"],"id":1276},{"start":{"row":47,"column":32},"end":{"row":47,"column":33},"action":"insert","lines":["a"]}],[{"start":{"row":47,"column":32},"end":{"row":47,"column":33},"action":"remove","lines":["a"],"id":1277}],[{"start":{"row":47,"column":32},"end":{"row":47,"column":33},"action":"remove","lines":["-"],"id":1278}],[{"start":{"row":47,"column":32},"end":{"row":47,"column":37},"action":"remove","lines":["links"],"id":1279}],[{"start":{"row":47,"column":32},"end":{"row":47,"column":33},"action":"insert","lines":["a"],"id":1280}],[{"start":{"row":47,"column":33},"end":{"row":47,"column":34},"action":"insert","lines":["d"],"id":1281}],[{"start":{"row":47,"column":34},"end":{"row":47,"column":35},"action":"insert","lines":["d"],"id":1282}],[{"start":{"row":47,"column":35},"end":{"row":47,"column":36},"action":"insert","lines":["-"],"id":1283}],[{"start":{"row":47,"column":36},"end":{"row":47,"column":37},"action":"insert","lines":["n"],"id":1284}],[{"start":{"row":47,"column":37},"end":{"row":47,"column":38},"action":"insert","lines":["e"],"id":1285}],[{"start":{"row":47,"column":38},"end":{"row":47,"column":39},"action":"insert","lines":["w"],"id":1286}],[{"start":{"row":47,"column":39},"end":{"row":47,"column":40},"action":"insert","lines":["-"],"id":1287}],[{"start":{"row":47,"column":40},"end":{"row":47,"column":41},"action":"insert","lines":["s"],"id":1288}],[{"start":{"row":47,"column":41},"end":{"row":47,"column":42},"action":"insert","lines":["i"],"id":1289}],[{"start":{"row":47,"column":42},"end":{"row":47,"column":43},"action":"insert","lines":["t"],"id":1290}],[{"start":{"row":47,"column":43},"end":{"row":47,"column":44},"action":"insert","lines":["e"],"id":1291}],[{"start":{"row":50,"column":0},"end":{"row":50,"column":11},"action":"remove","lines":["<% end %>  "],"id":1292}],[{"start":{"row":49,"column":38},"end":{"row":50,"column":0},"action":"remove","lines":["",""],"id":1293}],[{"start":{"row":53,"column":7},"end":{"row":53,"column":8},"action":"insert","lines":["#"],"id":1294}],[{"start":{"row":53,"column":8},"end":{"row":53,"column":9},"action":"insert","lines":["e"],"id":1295}],[{"start":{"row":53,"column":9},"end":{"row":53,"column":10},"action":"insert","lines":["d"],"id":1296}],[{"start":{"row":53,"column":10},"end":{"row":53,"column":11},"action":"insert","lines":["i"],"id":1297}],[{"start":{"row":53,"column":11},"end":{"row":53,"column":12},"action":"insert","lines":["t"],"id":1298}],[{"start":{"row":53,"column":12},"end":{"row":53,"column":13},"action":"insert","lines":["-"],"id":1299}],[{"start":{"row":53,"column":13},"end":{"row":53,"column":14},"action":"insert","lines":["l"],"id":1300}],[{"start":{"row":53,"column":14},"end":{"row":53,"column":15},"action":"insert","lines":["i"],"id":1301}],[{"start":{"row":53,"column":15},"end":{"row":53,"column":16},"action":"insert","lines":["n"],"id":1302}],[{"start":{"row":53,"column":16},"end":{"row":53,"column":17},"action":"insert","lines":["k"],"id":1303}],[{"start":{"row":53,"column":17},"end":{"row":53,"column":18},"action":"insert","lines":["s"],"id":1304}],[{"start":{"row":53,"column":18},"end":{"row":53,"column":19},"action":"insert","lines":[" "],"id":1305}],[{"start":{"row":58,"column":13},"end":{"row":58,"column":14},"action":"insert","lines":["#"],"id":1306}],[{"start":{"row":58,"column":14},"end":{"row":58,"column":15},"action":"insert","lines":["e"],"id":1307}],[{"start":{"row":58,"column":15},"end":{"row":58,"column":16},"action":"insert","lines":["d"],"id":1308}],[{"start":{"row":58,"column":16},"end":{"row":58,"column":17},"action":"insert","lines":["i"],"id":1309}],[{"start":{"row":58,"column":17},"end":{"row":58,"column":18},"action":"insert","lines":["t"],"id":1310}],[{"start":{"row":58,"column":18},"end":{"row":58,"column":19},"action":"insert","lines":["-"],"id":1311}],[{"start":{"row":58,"column":19},"end":{"row":58,"column":20},"action":"insert","lines":["l"],"id":1312}],[{"start":{"row":58,"column":20},"end":{"row":58,"column":21},"action":"insert","lines":["i"],"id":1313}],[{"start":{"row":58,"column":21},"end":{"row":58,"column":22},"action":"insert","lines":["n"],"id":1314}],[{"start":{"row":58,"column":22},"end":{"row":58,"column":23},"action":"insert","lines":["k"],"id":1315}],[{"start":{"row":58,"column":23},"end":{"row":58,"column":24},"action":"insert","lines":["s"],"id":1316}],[{"start":{"row":58,"column":24},"end":{"row":58,"column":25},"action":"insert","lines":[" "],"id":1317}],[{"start":{"row":62,"column":13},"end":{"row":62,"column":14},"action":"insert","lines":["#"],"id":1318}],[{"start":{"row":62,"column":14},"end":{"row":62,"column":15},"action":"insert","lines":[" "],"id":1319}],[{"start":{"row":62,"column":15},"end":{"row":62,"column":16},"action":"insert","lines":["e"],"id":1320}],[{"start":{"row":62,"column":15},"end":{"row":62,"column":16},"action":"remove","lines":["e"],"id":1321}],[{"start":{"row":62,"column":14},"end":{"row":62,"column":15},"action":"remove","lines":[" "],"id":1322}],[{"start":{"row":62,"column":14},"end":{"row":62,"column":15},"action":"insert","lines":["e"],"id":1323}],[{"start":{"row":62,"column":15},"end":{"row":62,"column":16},"action":"insert","lines":["d"],"id":1324}],[{"start":{"row":62,"column":16},"end":{"row":62,"column":17},"action":"insert","lines":["i"],"id":1325}],[{"start":{"row":62,"column":17},"end":{"row":62,"column":18},"action":"insert","lines":["t"],"id":1326}],[{"start":{"row":62,"column":18},"end":{"row":62,"column":19},"action":"insert","lines":["-"],"id":1327}],[{"start":{"row":62,"column":19},"end":{"row":62,"column":20},"action":"insert","lines":["l"],"id":1328}],[{"start":{"row":62,"column":20},"end":{"row":62,"column":21},"action":"insert","lines":["i"],"id":1329}],[{"start":{"row":62,"column":21},"end":{"row":62,"column":22},"action":"insert","lines":["n"],"id":1330}],[{"start":{"row":62,"column":22},"end":{"row":62,"column":23},"action":"insert","lines":["k"],"id":1331}],[{"start":{"row":62,"column":23},"end":{"row":62,"column":24},"action":"insert","lines":["s"],"id":1332}],[{"start":{"row":62,"column":24},"end":{"row":62,"column":25},"action":"insert","lines":[" "],"id":1333}],[{"start":{"row":45,"column":2},"end":{"row":45,"column":3},"action":"insert","lines":["<"],"id":1334}],[{"start":{"row":45,"column":3},"end":{"row":45,"column":4},"action":"insert","lines":["%"],"id":1335}],[{"start":{"row":45,"column":4},"end":{"row":45,"column":5},"action":"insert","lines":["e"],"id":1336}],[{"start":{"row":45,"column":5},"end":{"row":45,"column":6},"action":"insert","lines":["n"],"id":1337}],[{"start":{"row":45,"column":6},"end":{"row":45,"column":7},"action":"insert","lines":["d"],"id":1338}],[{"start":{"row":45,"column":7},"end":{"row":45,"column":8},"action":"insert","lines":[">"],"id":1339}],[{"start":{"row":45,"column":7},"end":{"row":45,"column":8},"action":"remove","lines":[">"],"id":1340}],[{"start":{"row":45,"column":7},"end":{"row":45,"column":8},"action":"insert","lines":[" "],"id":1341}],[{"start":{"row":45,"column":8},"end":{"row":45,"column":9},"action":"insert","lines":["%"],"id":1342}],[{"start":{"row":45,"column":9},"end":{"row":45,"column":10},"action":"insert","lines":[">"],"id":1343}],[{"start":{"row":45,"column":4},"end":{"row":45,"column":5},"action":"insert","lines":[" "],"id":1344}],[{"start":{"row":45,"column":0},"end":{"row":45,"column":2},"action":"remove","lines":["  "],"id":1345}],[{"start":{"row":50,"column":0},"end":{"row":50,"column":1},"action":"insert","lines":["<"],"id":1346}],[{"start":{"row":50,"column":1},"end":{"row":50,"column":2},"action":"insert","lines":["%"],"id":1347}],[{"start":{"row":50,"column":2},"end":{"row":50,"column":3},"action":"insert","lines":[" "],"id":1348}],[{"start":{"row":50,"column":3},"end":{"row":50,"column":4},"action":"insert","lines":["e"],"id":1349}],[{"start":{"row":50,"column":4},"end":{"row":50,"column":5},"action":"insert","lines":["n"],"id":1350}],[{"start":{"row":50,"column":5},"end":{"row":50,"column":6},"action":"insert","lines":["d"],"id":1351}],[{"start":{"row":50,"column":6},"end":{"row":50,"column":7},"action":"insert","lines":[" "],"id":1352}],[{"start":{"row":50,"column":7},"end":{"row":50,"column":8},"action":"insert","lines":["%"],"id":1353}],[{"start":{"row":50,"column":8},"end":{"row":50,"column":9},"action":"insert","lines":[">"],"id":1354}],[{"start":{"row":50,"column":0},"end":{"row":50,"column":9},"action":"remove","lines":["<% end %>"],"id":1355}],[{"start":{"row":49,"column":38},"end":{"row":50,"column":0},"action":"remove","lines":["",""],"id":1356}],[{"start":{"row":0,"column":61},"end":{"row":0,"column":62},"action":"insert","lines":["d"],"id":1357}],[{"start":{"row":0,"column":62},"end":{"row":0,"column":63},"action":"insert","lines":["o"],"id":1358}],[{"start":{"row":0,"column":63},"end":{"row":0,"column":64},"action":"insert","lines":[" "],"id":1359}],[{"start":{"row":47,"column":62},"end":{"row":47,"column":63},"action":"insert","lines":[" "],"id":1360}],[{"start":{"row":47,"column":63},"end":{"row":47,"column":64},"action":"insert","lines":["d"],"id":1361}],[{"start":{"row":47,"column":64},"end":{"row":47,"column":65},"action":"insert","lines":["o"],"id":1362}],[{"start":{"row":49,"column":38},"end":{"row":50,"column":0},"action":"insert","lines":["",""],"id":1363},{"start":{"row":50,"column":0},"end":{"row":50,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":50,"column":0},"end":{"row":50,"column":2},"action":"remove","lines":["  "],"id":1364}],[{"start":{"row":50,"column":0},"end":{"row":50,"column":1},"action":"insert","lines":["<"],"id":1365}],[{"start":{"row":50,"column":1},"end":{"row":50,"column":2},"action":"insert","lines":["%"],"id":1366}],[{"start":{"row":50,"column":2},"end":{"row":50,"column":3},"action":"insert","lines":[" "],"id":1367}],[{"start":{"row":50,"column":3},"end":{"row":50,"column":4},"action":"insert","lines":["e"],"id":1368}],[{"start":{"row":50,"column":4},"end":{"row":50,"column":5},"action":"insert","lines":["n"],"id":1369}],[{"start":{"row":50,"column":5},"end":{"row":50,"column":6},"action":"insert","lines":["d"],"id":1370}],[{"start":{"row":50,"column":6},"end":{"row":50,"column":7},"action":"insert","lines":[" "],"id":1371}],[{"start":{"row":50,"column":7},"end":{"row":50,"column":8},"action":"insert","lines":["%"],"id":1372}],[{"start":{"row":50,"column":8},"end":{"row":50,"column":9},"action":"insert","lines":[">"],"id":1373}],[{"start":{"row":50,"column":9},"end":{"row":51,"column":0},"action":"insert","lines":["",""],"id":1374}],[{"start":{"row":51,"column":0},"end":{"row":52,"column":0},"action":"insert","lines":["",""],"id":1375}]]},"ace":{"folds":[],"scrolltop":509,"scrollleft":0,"selection":{"start":{"row":49,"column":38},"end":{"row":49,"column":38},"isBackwards":false},"options":{"tabSize":2,"useSoftTabs":true,"guessTabSize":false,"useWrapMode":true,"wrapToView":true},"firstLineState":{"row":27,"state":"start","mode":"ace/mode/html_ruby"}},"timestamp":1537226264022}